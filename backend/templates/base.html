<!doctype html>
<title>Rank_N_Read - Flaskr</title>
<link rel="stylesheet" href="../static/styles.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Kanit&family=Montserrat&family=Open+Sans:wght@500&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<!-- <body>
    <div class="full-body-container">
        <div class="top-text">
            <div class="google-colors">
                <h1 id="google-4">4</h1>
                <h1 id="google-3">3</h1>
                <h1 id="google-0-1">0</h1>
                <h1 id="google-0-2">0</h1>
            </div>
            <div class="input-box" onclick="sendFocus()">
                <img src="{{ url_for('static', filename='images/mag.png') }}" />
                <input placeholder="Search for a Keeping up with the Kardashians episode" id="filter-text-val" onkeyup="filterText()">
            </div>
        </div>
        <div id="answer-box">

        </div>
    </div>

    <script>

        function answerBoxTemplate(title,titleDesc,rating){
            return `<div class=''>
                <h3 class='episode-title'>${title}</h3>
                <p class='episode-desc'>${titleDesc}</p>
                <p class='episode-rating'>IMDB Rating: ${rating}</p>
            </div>`
        }

        function sendFocus(){
            document.getElementById('filter-text-val').focus()
        }

        function filterText(){
            document.getElementById("answer-box").innerHTML = ""
            console.log(document.getElementById("filter-text-val").value)
            fetch("/getbooks?" + new URLSearchParams({ title: document.getElementById("filter-text-val").value }).toString())
            .then((response) => response.json())
            .then((data) => data.forEach(row => {
                
                let tempDiv = document.createElement("div")
                tempDiv.innerHTML = answerBoxTemplate(row.title,row.descr,row.imdb_rating)
                document.getElementById("answer-box").appendChild(tempDiv)
            }));

        }
            
    </script>
</body> -->
<body>
    <div class="full-body-container">
        <div class="container-fluid" id="container_home">
            <div class="home">
              <h1 style="color: rgb(21, 19, 19); text-align: center; padding-top: 30px">
                RANK_N_READ
              </h1>
            </div>
        </div>
        <div class="container" id="input_form">
            <div class="container-sm" id="form">
                <div class="mb-3">
                    <label for="formGroupBookTitle" class="form-label">Book Title</label>
                    <input type="text" class="form-control" id="formGroupExampleInput" placeholder="Example input placeholder">
                  </div>
                  <div class="mb-3">
                    <label for="formGroupExampleInput2" class="form-label">Author</label>
                    <input type="text" class="form-control" id="formGroupExampleInput2" placeholder="Another input placeholder">
                  </div>
                  <div class="mb-3">
                    <label for="formGroupExampleInput2" class="form-label">Category</label>
                    <input type="text" class="form-control" id="formGroupExampleInput2" placeholder="Another input placeholder">
                  </div>
                  <div class="d-grid gap-2 col-6 mx-auto" id="rec-button">
                    <button class="btn btn-primary" type="button">Find Recommendations</button>
                  </div>
            </div>
        </div>

        <div id="books-container"></div>

        <div class="footer">
            Elizabeth Vera Atieno | Brandon Boit | Mnumzana Moyo | Peter Wainaina | Benjamin Mukeku
        </div>
    </div>
    
    <script>
        document.getElementById("rec-button").addEventListener("click", function() {
            // alert("Feature coming soon! Personalized book recommendations will be available here.");

            fetch('/getbooks')
                .then(response => response.json())
                .then(data => {
                const container = document.getElementById('books-container');
                // Clear any existing content
                container.innerHTML = '';
                data.forEach(book => {
                    // Create the book card container
                    const card = document.createElement('div');
                    card.className = 'book-card';
                    
                    // If an image exists, create an <img> element.
                    if (book.image) {
                    const image = document.createElement('img');
                    image.className = 'book-image';
                    image.src = book.image;
                    image.alt = book.title;
                    card.appendChild(image);
                    }
                    
                    // Create a container for text information.
                    const info = document.createElement('div');
                    info.className = 'book-info';
                    
                    // Title
                    const title = document.createElement('div');
                    title.className = 'book-title';
                    title.textContent = book.title;
                    info.appendChild(title);
                    
                    // Categories (join if it's an array)
                    const categories = document.createElement('p');
                    categories.className = 'book-meta';
                    categories.textContent = 'Categories: ' + (Array.isArray(book.categories) ? book.categories.join(', ') : book.categories);
                    info.appendChild(categories);
                    
                    // Authors (join if it's an array)
                    const authors = document.createElement('p');
                    authors.className = 'book-meta';
                    authors.textContent = 'Author(s): ' + (Array.isArray(book.authors) ? book.authors.join(', ') : book.authors);
                    info.appendChild(authors);
                    
                    // Published Date
                    const publishedDate = document.createElement('p');
                    publishedDate.className = 'book-meta';
                    publishedDate.textContent = 'Published Date: ' + book.publishedDate;
                    info.appendChild(publishedDate);
                    
                    // Description
                    const description = document.createElement('p');
                    description.className = 'book-description';
                    description.textContent = book.description;
                    info.appendChild(description);
                    
                    // Append the info container to the card.
                    card.appendChild(info);
                    // Append the card to the main container.
                    container.appendChild(card);
                });
                })
                .catch(error => console.error('Error fetching books:', error));
            });
    </script>
    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>